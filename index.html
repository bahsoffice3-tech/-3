<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡¶ß‡ßÇ‡¶Æ‡¶ï‡ßá‡¶§‡ßÅ</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <!-- Local CSS -->
    <link rel="stylesheet" href="style.css">
  <!-- New Exam Theme CSS -->
    <link rel="stylesheet" href="exam-theme.css">
</head>
<body>
    <!-- Auth Screen -->
    <div id="authScreen">
        <div class="auth-box">
            <div class="text-center mb-6">
                <i class="fas fa-meteor text-primary" style="font-size: 3rem;"></i>
                <h2 class="mt-2 text-primary">‡¶ß‡ßÇ‡¶Æ‡¶ï‡ßá‡¶§‡ßÅ</h2>
                <p class="text-light text-sm">Ultimate Education Platform</p>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm">
                <div class="input-group">
                    <input type="tel" id="loginMobile" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" value="01700000000">
                </div>
                <div class="input-group">
                    <input type="password" id="loginPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" value="1234">
                    <i class="fas fa-eye pass-toggle" onclick="togglePass('loginPass', this)"></i>
                </div>
                <div class="flex gap-2 mb-4">
                    <input type="checkbox" id="rememberMe" style="width: auto;">
                    <label for="rememberMe" class="text-sm">‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®</label>
                </div>
                <button class="btn mb-4" onclick="handleLogin()">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <div class="flex flex-between text-sm">
                    <span class="text-primary font-bold cursor-pointer" onclick="toggleAuth('reg')">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</span>
                    <span class="text-light cursor-pointer" onclick="toggleAuth('admin')">‚≠ï</span>
                </div>
            </div>
            
            <!-- Admin Login Form -->
            <div id="adminForm" class="hidden">
                <h4 class="mb-4 text-center text-danger">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</h4>
                <input type="text" id="adminUser" placeholder="‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ü‡¶á‡¶°‡¶ø" value="admin">
                <div class="input-group">
                    <input type="password" id="adminPassInput" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" value="1234">
                    <i class="fas fa-eye pass-toggle" onclick="togglePass('adminPassInput', this)"></i>
                </div>
                <button class="btn btn-danger mb-4" onclick="handleAdminLogin()">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</button>
                <div class="text-center text-sm text-primary cursor-pointer" onclick="toggleAuth('login')">‚ùå</div>
            </div>
            
            <!-- Registration Form -->
            <div id="regForm" class="hidden">
                <h4 class="mb-4 text-center text-success">‡¶®‡¶§‡ßÅ‡¶® ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</h4>
                <input type="text" id="regName" placeholder="‡¶®‡¶æ‡¶Æ">
                <select id="regClass">
                    <option value="Class 6">Class 6</option>
                    <option value="Class 7">Class 7</option>
                    <option value="Class 8">Class 8</option>
                    <option value="Class 9">Class 9</option>
                    <option value="Class 10" selected>Class 10</option>
                    <option value="SSC">SSC</option>
                    <option value="HSC">HSC</option>
                </select>
                <input type="tel" id="regMob" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
                <input type="password" id="regPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
                <button class="btn btn-success" onclick="handleRegister()">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <div class="text-center mt-2 text-sm cursor-pointer" onclick="toggleAuth('login')">üîô</div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden">
        <nav class="navbar">
            <div class="nav-brand"><i class="fas fa-book-reader"></i> <span id="headerTitle">‡¶π‡ßã‡¶Æ</span></div>
            <div class="flex gap-3 items-center">
                <div class="text-right">
                    <div class="text-xs text-light" id="navName">User</div>
                    <div class="text-sm font-bold text-success" id="navBal">‡ß≥0</div>
                </div>
                <img src="" id="navAvatar" style="width:35px; height:35px; border-radius:50%; object-fit:cover;" onerror="this.src='https://via.placeholder.com/35'">
                <i class="fas fa-power-off logout-btn-nav" onclick="logoutConfirm()" title="Logout"></i>
            </div>
        </nav>

        <div class="marquee-container">
            <div class="marquee-content" id="marqueeText">Loading Notice...</div>
        </div>

        <div class="p-4">
            <!-- Home View -->
            <div id="view-home" class="view">
                <a href="https://rds5545.blogspot.com/?m=1" target="_blank" class="card flex flex-between" style="text-decoration: none; border-left: 4px solid #f59e0b;">
                    <div class="flex gap-3">
                        <i class="fas fa-comet fa-2x text-warning"></i>
                        <div><b class="text-primary">‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶∞ ‡¶ß‡ßÇ‡¶Æ‡¶ï‡ßá‡¶§‡ßÅ</b><div class="text-xs text-light">‡¶Ö‡¶´‡¶ø‡¶∏‡¶ø‡ßü‡¶æ‡¶≤ ‡¶¨‡ßç‡¶≤‡¶ó</div></div>
                    </div>
                    <i class="fas fa-chevron-right text-light"></i>
                </a>

                <div class="card bg-indigo-50 border-indigo-100 flex flex-between">
                    <div><h4 class="text-primary">RDS Library</h4><p class="text-xs text-light">Main External Library</p></div>
                    <a href="https://mahamuds5545-afk.github.io/RDS_Libary/" target="_blank" class="btn btn-sm btn-outline">Visit <i class="fas fa-external-link-alt"></i></a>
                </div>
                
                <h4 class="mb-2 text-light"><i class="fas fa-rss"></i> ‡¶®‡¶ø‡¶â‡¶ú‡¶´‡¶ø‡¶°</h4>
                <div id="postFilterContainer" class="flex gap-2 overflow-x-auto pb-2 mb-2" style="scrollbar-width: none;">
                    <button class="filter-btn active" onclick="filterPosts('All', this)">‡¶∏‡¶¨</button>
                </div>
                <div id="postsContainer"></div>
            </div>

            <!-- Exam View -->
            <div id="view-exam" class="view hidden">
                <h4 class="mb-4 text-light">‡¶ö‡¶≤‡¶Æ‡¶æ‡¶® ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ</h4>
                <div id="examList"></div>
            </div>

            <!-- Library View -->
            <div id="view-library" class="view hidden">
                <div class="card flex flex-between">
                    <div class="flex gap-2"><i class="fas fa-globe fa-2x text-primary"></i><div><b>RDS Main Library</b><div class="text-xs text-light">Official Site</div></div></div>
                    <a href="https://mahamuds5545-afk.github.io/RDS_Libary/" target="_blank" class="btn btn-sm">Open</a>
                </div>
                <h4 class="mb-2 text-light">‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶ì ‡¶®‡ßã‡¶ü‡¶∏</h4>
                <div id="libList"></div>
            </div>

            <!-- Wallet View -->
            <div id="view-wallet" class="view hidden">
                <div class="card text-center py-6" style="background: linear-gradient(135deg, #4338ca, #6366f1); color: white;">
                    <p class="text-sm">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
                    <h1 class="my-2" style="font-size: 2.5rem;" id="walletBigBal">‡ß≥0</h1>
                    <div class="flex gap-2 justify-center mt-4">
                        <button class="btn bg-white text-primary w-auto px-6" onclick="showModal('deposit')"><i class="fas fa-plus"></i> ‡¶ú‡¶Æ‡¶æ</button>
                        <button class="btn bg-white/20 text-white w-auto px-6" onclick="showModal('withdraw')"><i class="fas fa-arrow-down"></i> ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</button>
                    </div>
                </div>
                <h4 class="mb-2 text-light">‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶® ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏</h4>
                <div id="txHistory"></div>
            </div>

            <!-- Profile View -->
            <div id="view-profile" class="view hidden">
                <div class="card text-center">
                    <img id="profileAvatar" src="" class="profile-pic" onerror="this.src='https://via.placeholder.com/100'">
                    <h3 id="profileName">User</h3>
                    <p class="text-light text-sm mb-4" id="profileMobile">017XXXXXXXX</p>
                    <button class="btn btn-sm btn-outline w-full mb-2" onclick="document.getElementById('editSection').classList.toggle('hidden')"><i class="fas fa-edit"></i> ‡¶è‡¶°‡¶ø‡¶ü ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</button>

                    <div id="editSection" class="hidden text-left mt-2 bg-gray-50 p-2 rounded">
                        <label class="text-xs font-bold text-light">‡¶®‡¶æ‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</label>
                        <input type="text" id="editName">
                        <label class="text-xs font-bold text-light">‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</label>
                        <input type="text" id="editPass">
                        <label class="text-xs font-bold text-light">‡¶™‡¶ø‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</label>
                        <input type="file" id="editPicFile" accept="image/*">
                        <button class="btn btn-sm" id="btnUpdateProfile" onclick="updateProfile()">Save Changes</button>
                    </div>
                </div>

                <div class="card">
                    <h4 class="mb-2 text-primary"><i class="fas fa-envelope"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</h4>
                    <div class="flex gap-2">
                        <input type="text" id="userMsgInput" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." style="margin-bottom:0;">
                        <button class="btn btn-sm w-auto" onclick="sendMsgToAdmin()"><i class="fas fa-paper-plane"></i></button>
                    </div>
                    <div id="userMsgList" class="mt-4"></div>
                </div>
            </div>

            <!-- Admin View -->
            <div id="view-admin" class="view hidden">
                <div class="card bg-gray-100 flex flex-between">
                    <span>External Admin Panel</span>
                    <a href="https://mahamuds5545-afk.github.io/RDS_Libary/admin" target="_blank" class="btn btn-sm btn-outline">Go <i class="fas fa-external-link-alt"></i></a>
                </div>

                <div class="flex gap-2 mb-4 overflow-x-auto pb-2">
                    <button class="btn btn-sm" onclick="admTab('users')">‡¶õ‡¶æ‡¶§‡ßç‡¶∞‡¶õ‡¶æ‡¶§‡ßç‡¶∞‡ßÄ</button>
                    <button class="btn btn-sm" onclick="admTab('pay')">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</button>
                    <button class="btn btn-sm" onclick="admTab('msg')">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú</button>
                    <button class="btn btn-sm" onclick="admTab('exam')">‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ</button>
                    <button class="btn btn-sm" onclick="admTab('post')">‡¶™‡ßã‡¶∏‡ßç‡¶ü</button>
                    <button class="btn btn-sm" onclick="admTab('lib')">‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø</button>
                    <button class="btn btn-sm" onclick="admTab('set')">‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</button>
                </div>

                <div id="adm-users" class="adm-sec">
                    <div class="flex flex-between mb-4">
                        <h4 class="text-light">‡¶õ‡¶æ‡¶§‡ßç‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</h4>
                        <input type="text" id="searchStudent" placeholder="‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®..." class="w-auto" style="width: 150px;" onkeyup="searchStudents(this.value)">
                    </div>
                    <div id="admUserList"></div>
                </div>

                <div id="adm-pay" class="adm-sec hidden">
                    <h4 class="mb-2 text-primary">Pending Requests</h4>
                    <div id="admPayList"></div>
                    <h4 class="mb-2 mt-4 text-light">Payment History</h4>
                    <div id="admPayHistory"></div>
                </div>

                <div id="adm-msg" class="adm-sec hidden">
                    <h4 class="mb-2 text-light">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú</h4>
                    <div id="admMsgList"></div>
                </div>

                <div id="adm-exam" class="adm-sec hidden">
                    <div class="card">
                        <h4 id="examModalTitle">Create Exam</h4>
                        <input type="hidden" id="exIdx" value="-1">
                        <input type="hidden" id="editExamId" value="">
                        <label class="text-xs">Exam Mode</label>
                        <select id="exMode" onchange="toggleMode()">
                            <option value="Native">Native MCQ</option>
                            <option value="Google">Google Form</option>
                        </select>
                        
                        <input type="text" id="exTitle" placeholder="Exam Title">
                        <select id="exClass">
                            <option value="All">All Classes</option>
                            <option value="Class 6">Class 6</option>
                            <option value="Class 7">Class 7</option>
                            <option value="Class 8">Class 8</option>
                            <option value="Class 9">Class 9</option>
                            <option value="Class 10">Class 10</option>
                            <option value="SSC">SSC</option>
                            <option value="HSC">HSC</option>
                        </select>
                        <div class="flex gap-2">
                            <input type="datetime-local" id="exStart">
                            <input type="datetime-local" id="exEnd">
                        </div>
                        <div class="flex gap-2">
                            <input type="number" id="exDur" placeholder="Duration (Min)">
                            <input type="number" id="exFee" placeholder="Entry Fee">
                        </div>
                        <div class="flex gap-2">
                            <input type="number" id="exPrize" placeholder="Total Prize" value="0">
                            <input type="number" id="exGift" placeholder="Gift Amount" value="0">
                        </div>
                        
                        <div id="googleMode" class="hidden">
                            <input type="text" id="exLink" placeholder="Google Form Link">
                        </div>

                        <div id="nativeMode">
                            <hr class="my-4">
                            <div class="flex flex-between mb-2">
                                <label class="font-bold">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</label>
                                <button class="btn btn-sm w-auto" onclick="addQ()"><i class="fas fa-plus"></i> ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</button>
                            </div>
                            <div id="qList" class="flex-col gap-2"></div>
                        </div>

                        <button class="btn btn-success" id="btnSave" onclick="saveExam()">Save Exam</button>
                        <button class="btn btn-danger hidden" id="btnCancelEdit" onclick="cancelEditExam()">Cancel Edit</button>
                    </div>
                    <h4 class="mb-2 mt-4 text-light">Existing Exams</h4>
                    <div id="admExList"></div>
                </div>

                <div id="adm-post" class="adm-sec hidden">
                    <div class="card">
                        <h4>‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßã‡¶∏‡ßç‡¶ü</h4>
                        <label class="text-xs">‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</label>
                        <select id="admPostCategory" class="mb-2">
                            <option value="General">General</option>
                        </select>
                        <input type="text" id="admPostTitle" placeholder="‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤">
                        <textarea id="admPostContent" rows="3" placeholder="‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§..."></textarea>
                        <textarea id="admPostTranslation" rows="2" placeholder="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)"></textarea>
                        <label class="text-xs">‡¶õ‡¶¨‡¶ø</label>
                        <input type="file" id="admPostImg" accept="image/*">
                        <input type="text" id="admPostLink" placeholder="Link">
                        <input type="text" id="admPostLinkTxt" placeholder="Button Text">
                        <button class="btn" id="btnPost" onclick="admAddPost()">‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                    <h4 class="mb-2 mt-6 text-light">‡¶∏‡¶ï‡¶≤ ‡¶™‡ßã‡¶∏‡ßç‡¶ü</h4>
                    <div id="allPostsList"></div>
                </div>
                
                <div id="adm-lib" class="adm-sec hidden">
                    <div class="card">
                        <h4>‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø</h4>
                        <input type="text" id="libTitle" placeholder="‡¶®‡¶æ‡¶Æ">
                        <input type="text" id="libLink" placeholder="Link">
                        <select id="libType">
                            <option>PDF</option>
                            <option>Video</option>
                        </select>
                        <button class="btn" onclick="admAddLib()">‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                </div>
                
                <div id="adm-set" class="adm-sec hidden">
                    <div class="card">
                        <h4>‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</h4>
                        <label class="text-xs">‡¶®‡ßã‡¶ü‡¶ø‡¶∂</label>
                        <input type="text" id="setNotice">
                        <div class="flex gap-2">
                            <div>
                                <label class="text-xs">bKash</label>
                                <input type="text" id="setBkash">
                            </div>
                            <div>
                                <label class="text-xs">Nagad</label>
                                <input type="text" id="setNagad">
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <div>
                                <label class="text-xs">Min Dep</label>
                                <input type="number" id="setMinDep">
                            </div>
                            <div>
                                <label class="text-xs">Min Wd</label>
                                <input type="number" id="setMinWd">
                            </div>
                        </div>
                        <button class="btn" onclick="admSaveSet()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                        <hr class="my-4" style="border-top: 1px solid #eee;">
                        <h4>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h4>
                        <div class="flex gap-2">
                            <input type="text" id="newCatName" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶®‡¶æ‡¶Æ (‡¶Ø‡ßá‡¶Æ‡¶®: Notice)">
                            <button class="btn w-auto" onclick="admAddCategory()"><i class="fas fa-plus"></i></button>
                        </div>
                        <div id="admCatList" class="flex gap-2 flex-wrap mt-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item active" onclick="nav('home', this)"><i class="fas fa-home"></i> ‡¶π‡ßã‡¶Æ</button>
            <button class="nav-item" onclick="nav('exam', this)"><i class="fas fa-clipboard-check"></i> ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ</button>
            <button class="nav-item" onclick="nav('library', this)"><i class="fas fa-book"></i> ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø</button>
            <button class="nav-item" onclick="nav('wallet', this)"><i class="fas fa-wallet"></i> ‡¶ì‡ßü‡¶æ‡¶≤‡ßá‡¶ü</button>
            <button class="nav-item" onclick="nav('profile', this)"><i class="fas fa-user-circle"></i> ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</button>
            <button class="nav-item hidden" id="navAdminBtn" onclick="nav('admin', this)"><i class="fas fa-shield-alt"></i></button>
        </div>
    </div>

    <!-- Modals -->
    <div id="modal-deposit" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3>‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <div class="card bg-gray-50 text-sm">
                <div class="flex flex-between mb-2">
                    <span>bKash: <b id="viewBkash">...</b></span>
                    <button class="btn-sm btn-outline" onclick="copy('viewBkash')">Copy</button>
                </div>
                <div class="flex flex-between">
                    <span>Nagad: <b id="viewNagad">...</b></span>
                    <button class="btn-sm btn-outline" onclick="copy('viewNagad')">Copy</button>
                </div>
                <div class="text-center mt-2 text-xs text-light">Min Deposit: ‡ß≥<span id="viewMinDep"></span></div>
            </div>
            <input type="number" id="depAmt" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
            <select id="depMethod">
                <option>bKash</option>
                <option>Nagad</option>
            </select>
            <input type="text" id="depTrx" placeholder="TrxID">
            <button class="btn btn-success" onclick="reqDep()">Send Request</button>
        </div>
    </div>

    <div id="modal-withdraw" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3>‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <p class="text-center text-sm mb-4">Min Withdraw: ‡ß≥<span id="viewMinWd"></span></p>
            <input type="number" id="wdAmt" placeholder="Amount">
            <select id="wdMethod">
                <option>bKash</option>
                <option>Nagad</option>
            </select>
            <input type="text" id="wdNum" placeholder="Phone Number">
            <button class="btn btn-danger" onclick="reqWd()">Withdraw</button>
        </div>
    </div>

    <div id="modal-edit-user" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3>Edit Student</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <input type="hidden" id="editUserMobile">
            <div class="text-center mb-4">
                <img id="editUserAvatar" src="" class="profile-pic-small" style="display: inline-block;" onerror="this.src='https://via.placeholder.com/50'">
            </div>
            <input type="text" id="editUserName" placeholder="Name">
            <select id="editUserClass">
                <option value="Class 6">Class 6</option>
                <option value="Class 7">Class 7</option>
                <option value="Class 8">Class 8</option>
                <option value="Class 9">Class 9</option>
                <option value="Class 10">Class 10</option>
                <option value="SSC">SSC</option>
                <option value="HSC">HSC</option>
            </select>
            <div class="flex gap-2 mb-4">
                <input type="number" id="editUserBal" placeholder="Balance">
                <input type="password" id="editUserPass" placeholder="Password">
            </div>
            <label class="text-xs font-bold text-light">‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶ø‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</label>
            <input type="file" id="editUserPicFile" accept="image/*">
            <div class="flex gap-2 mt-4">
                <button class="btn btn-success" onclick="saveUserChanges()">Save Changes</button>
                <button class="btn btn-danger" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div id="modal-exam" class="modal hidden">
        <div class="modal-content" style="border-radius: 0; max-width: 100%; height: 100%; padding: 0;">
            <div class="timer-bar">
                <span id="runExamTitle">Exam</span>
                <span id="timerDisplay">00:00</span>
            </div>
            <div id="examBody" class="p-4" style="padding-bottom: 80px;"></div>
            <div style="position: fixed; bottom: 0; left: 0; width: 100%; padding: 12px; background: white; border-top: 1px solid var(--border); display: flex; gap: 8px;">
                <button class="btn btn-danger w-1/3" onclick="closeModal()">Exit</button>
                <button class="btn btn-success w-2/3" onclick="submitExam()">Submit</button>
            </div>
        </div>
    </div>

    <div id="modal-leaderboard" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3><i class="fas fa-trophy text-warning"></i> ‡¶Æ‡ßá‡¶∞‡¶ø‡¶ü ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <div class="card bg-indigo-50 text-center p-2 mb-2 text-xs">
                ‡¶è‡¶á ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ‡ßá ‡¶Ö‡¶Ç‡¶∂‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞
            </div>
            <div id="leaderboardBody" style="max-height: 400px; overflow-y: auto;"></div>
        </div>
    </div>

    <div id="modal-result-view" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3>‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶™‡¶§‡ßç‡¶∞</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <div id="resultDetailsBody" style="padding-bottom: 20px;"></div>
        </div>
    </div>

    <div id="modal-attendees" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between mb-4">
                <h3 id="attendeeTitle">Exam Attendees</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <div id="attendeeListContent"></div>
        </div>
    </div>

    <div id="modal-edit-post" class="modal hidden">
        <div class="modal-content edit-post-modal">
            <div class="flex flex-between mb-4">
                <h3>‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                <i class="fas fa-times" onclick="closeModal()"></i>
            </div>
            <input type="hidden" id="editPostId">
            <label class="text-xs">‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</label>
            <select id="editPostCategoryInput" class="mb-2"></select>
            <input type="text" id="editPostTitle" placeholder="‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤">
            <textarea id="editPostContent" rows="4" placeholder="‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§..."></textarea>
            <textarea id="editPostTranslation" rows="2" placeholder="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)"></textarea>
            <div class="mb-4">
                <label class="text-xs font-bold text-light">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø</label>
                <img id="currentPostImage" src="" style="max-width: 100%; border-radius: 8px; margin-top: 5px; max-height: 200px; object-fit: cover;" onerror="this.style.display='none'">
            </div>
            <label class="text-xs font-bold text-light">‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label>
            <input type="file" id="editPostImg" accept="image/*">
            <input type="text" id="editPostLink" placeholder="‡¶≤‡¶ø‡¶Ç‡¶ï">
            <input type="text" id="editPostLinkTxt" placeholder="‡¶¨‡¶æ‡¶ü‡¶® ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü">
            <div class="flex gap-2 mt-6">
                <button class="btn btn-success" onclick="updatePost()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button class="btn btn-danger" onclick="closeModal()">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <!-- JavaScript Files -->
<script src="firebase-config.js"></script>
<script src="database.js"></script>
<script src="auth.js"></script>
<script src="utility.js"></script>
<script src="ui-render.js"></script>
<script src="user-functions.js"></script>
<script src="post-system.js"></script>
<script src="exam-system.js"></script>
<script src="exam-render.js"></script>  <!-- ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶æ‡¶á‡¶≤ -->
<script src="wallet-system.js"></script>
<script src="admin-functions.js"></script>
<script src="navigation.js"></script>
    
    <!-- Initialize App -->
    <<script>
        // Enable debugging
        const DEBUG = true;
        
        // Debug function
        function debugLog(message, data = null) {
            if (DEBUG) {
                console.log(`[DEBUG] ${message}`, data || '');
                
                // Show in debug info div
                const debugDiv = document.getElementById('debugInfo');
                if (debugDiv) {
                    const timestamp = new Date().toLocaleTimeString();
                    debugDiv.innerHTML = `${timestamp}: ${message}`;
                    debugDiv.style.display = 'block';
                    
                    // Hide after 3 seconds
                    setTimeout(() => {
                        debugDiv.style.display = 'none';
                    }, 3000);
                }
            }
        }
        
        // Override console.log for debugging
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            
            // Also log to debug div if it's an important message
            const firstArg = args[0];
            if (typeof firstArg === 'string' && 
                (firstArg.includes('üî•') || firstArg.includes('‚ùå') || firstArg.includes('‚úÖ') || 
                 firstArg.includes('üöÄ') || firstArg.includes('üì°') || firstArg.includes('üé®'))) {
                debugLog(firstArg);
            }
        };
        
        // Handle errors
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Global error:", message, error);
            debugLog(`Error: ${message}`);
            return true;
        };
    </script>
    
    <!-- Initialize App -->
    <script>
        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', async function() {
            console.log("üöÄ DOM Content Loaded");
            
            // Check for saved login
            const savedUser = localStorage.getItem('mrds_user');
            const savedPass = localStorage.getItem('mrds_pass');
            
            console.log("üì± Saved login:", savedUser ? "Found" : "Not found");
            
            if (savedUser && savedPass) {
                document.getElementById('loginMobile').value = savedUser;
                document.getElementById('loginPass').value = savedPass;
                document.getElementById('rememberMe').checked = true;
            }
            
            // Initialize database
            console.log("üîÑ Initializing database...");
            try {
                const dbInitialized = await initializeDatabase();
                if (dbInitialized) {
                    console.log("‚úÖ Database initialized successfully");
                    
                    // Try auto-login if credentials exist
                    if (savedUser && savedPass) {
                        console.log("üîê Attempting auto-login...");
                        document.getElementById('loginMobile').value = savedUser;
                        document.getElementById('loginPass').value = savedPass;
                        // Uncomment to enable auto-login
                        // handleLogin();
                    }
                } else {
                    console.error("‚ùå Database initialization failed");
                    alert("‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                }
            } catch (error) {
                console.error("‚ùå Initialization error:", error);
                alert("‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá: " + error.message);
            }
        });
        
        // Handle page visibility changes
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'visible') {
                console.log("üîÑ Page became visible, checking auth...");
                if (CURR_USER) {
                    console.log("üë§ Current user:", CURR_USER.name);
                }
            }
        });
    </script>
</body>
</html>
